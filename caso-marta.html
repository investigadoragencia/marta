<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contrato – Agência Investigador</title>
  <style>
    :root{
      --bg:#071022;
      --card:#0b1220;
      --accent:#00d4b4;
      --muted:#98a8b6;
      --text:#e6eef8;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,Roboto,Arial,sans-serif;
      background:linear-gradient(180deg,#071022 0%, #071733 100%);
      color:var(--text);
      padding:12px;
      display:flex;
      justify-content:center;
    }
    .wrap{max-width:520px;width:100%}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;
      padding:16px;
      box-shadow:0 12px 40px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.02);
    }
    .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .header h1{margin:0;color:var(--accent);font-size:18px}
    .content{
      background:var(--glass);
      border-radius:10px;
      padding:12px;
      max-height:320px;
      overflow:auto;
      font-size:14px;
      line-height:1.5;
      color:var(--text);
    }
    .content p{margin:8px 0}
    .sig-area{margin-top:12px}
    canvas{
      width:100%;
      height:180px;
      border-radius:10px;
      border:1px dashed rgba(255,255,255,0.06);
      background:rgba(255,255,255,0.01);
      margin-top:8px;
      touch-action:none;
    }
    .actions{display:flex;gap:8px;margin-top:12px}
    button{
      flex:1;
      padding:10px;
      border-radius:10px;
      border:0;
      background:var(--accent);
      color:#021018;
      font-weight:700;
      cursor:pointer;
    }
    button.secondary{
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--muted);
      font-weight:600;
    }
    .note{font-size:12px;color:var(--muted);margin-top:10px}
    footer{margin-top:14px;text-align:center;color:var(--muted);font-size:12px}
    @media (max-width:420px){ .card{padding:12px} .header h1{font-size:16px} }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="header">
        <h1>Contrato de Autorização</h1>
        <div>
          <button id="backBtn" class="secondary">Voltar</button>
        </div>
      </div>

      <div class="content" id="contractText">
        <p><strong>CONTRATO DE AUTORIZAÇÃO DE INVESTIGAÇÃO</strong></p>

        <p>Eu, <strong>Marta</strong>, doravante denominada CONTRATANTE, autorizo a empresa <strong>Agência Investigador</strong>,
        doravante denominada CONTRATADA, a realizar investigação particular e confidencial sobre os fatos por mim relatados.</p>

        <p><strong>Cláusula 1 – Objeto:</strong> Realização de diligências, vigilância e coleta de evidências (fotografias, imagens, registros)
        para fins de esclarecimento do caso.</p>

        <p><strong>Cláusula 2 – Sigilo:</strong> A CONTRATADA manterá sigilo absoluto sobre todas as informações coletadas, salvo determinação judicial.</p>

        <p><strong>Cláusula 3 – Limites e Responsabilidade:</strong> A CONTRATADA atuará dentro dos limites legais; não se responsabiliza por fatos
        decorrentes de atos de terceiros ou decisões judiciais.</p>

        <p><strong>Cláusula 4 – Vigência:</strong> Este instrumento entra em vigor na data da assinatura digital e permanece vigente até a conclusão do serviço.</p>

        <p><strong>Data:</strong> <span id="dateNow"></span></p>
      </div>

      <div class="sig-area">
        <p style="margin:6px 0 0;color:var(--muted)">Assine abaixo para confirmar a autorização (toque para assinar):</p>
        <canvas id="signature" aria-label="Campo de assinatura"></canvas>

        <div class="actions">
          <button id="clearSig" class="secondary">Limpar</button>
          <button id="saveSig">Salvar e Confirmar</button>
        </div>

        <div class="note">Ao salvar a assinatura, ela será vinculada ao contrato e armazenada temporariamente localmente no dispositivo. Para registro externo, exporte ou envie conforme processo da agência.</div>
      </div>

      <footer>Agência Investigador © 2025</footer>
    </div>
  </div>

<script>
  // mostrar data atual
  document.getElementById('dateNow').textContent = new Date().toLocaleDateString('pt-BR');

  // voltar ao painel (caso-marta.html)
  document.getElementById('backBtn').addEventListener('click', ()=> {
    location.href = 'caso-marta.html';
  });

  // canvas (touch + pointer friendly)
  const canvas = document.getElementById('signature');
  const ctx = canvas.getContext('2d');
  let drawing = false;

  function setSize(){
    // ajustar alta resolução sem redimensionar estilo
    const ratio = window.devicePixelRatio || 1;
    const w = canvas.offsetWidth;
    const h = canvas.offsetHeight;
    canvas.width = Math.round(w * ratio);
    canvas.height = Math.round(h * ratio);
    canvas.style.width = w + 'px';
    canvas.style.height = h + 'px';
    ctx.setTransform(ratio,0,0,ratio,0,0);
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
  }
  window.addEventListener('load', setSize);
  window.addEventListener('resize', setSize);

  function getPos(e){
    const rect = canvas.getBoundingClientRect();
    if(e.touches && e.touches.length) {
      return { x: e.touches[0].clientX - rect.left, y: e.touches[0].clientY - rect.top };
    }
    return { x: e.clientX - rect.left, y: e.clientY - rect.top };
  }

  canvas.addEventListener('pointerdown', e => {
    drawing = true;
    const p = getPos(e);
    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
    e.preventDefault();
  });
  canvas.addEventListener('pointermove', e => {
    if(!drawing) return;
    const p = getPos(e);
    ctx.lineTo(p.x, p.y);
    ctx.strokeStyle = '#00d4b4';
    ctx.lineWidth = 2;
    ctx.stroke();
    e.preventDefault();
  });
  canvas.addEventListener('pointerup', ()=> drawing=false);
  canvas.addEventListener('pointercancel', ()=> drawing=false);
  canvas.addEventListener('pointerleave', ()=> drawing=false);

  // limpar
  document.getElementById('clearSig').addEventListener('click', ()=>{
    // limpar desenho
    ctx.clearRect(0,0,canvas.width,canvas.height);
  });

  // salvar (gera imagem, grava em localStorage e volta para painel)
  document.getElementById('saveSig').addEventListener('click', ()=>{
    // cria canvas export com tamanho real
    const exportCanvas = document.createElement('canvas');
    exportCanvas.width = canvas.width;
    exportCanvas.height = canvas.height;
    const ectx = exportCanvas.getContext('2d');
    // desenha atual (considerando transform)
    ectx.drawImage(canvas, 0, 0, exportCanvas.width, exportCanvas.height);
    const dataURL = exportCanvas.toDataURL('image/png');
    try {
      localStorage.setItem('assinatura_marta', dataURL);
    } catch(e) {
      console.warn('Não foi possível salvar localmente:', e);
    }
    alert('Assinatura salva e vinculada ao contrato.');
    // volta ao painel
    location.href = 'caso-marta.html';
  });
</script>
</body>
</html>
